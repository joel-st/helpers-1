!function(e,t){"object"==typeof exports&&exports?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Mustache={})}(this,function(e){function t(e){return"function"==typeof e}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return g.call(e,t)}function i(e){return!r(w,e)}function s(e){return String(e).replace(/[&<>"'\/]/g,function(e){return d[e]})}function o(t,r){function s(){if(g&&!w)for(;p.length;)delete l[p.pop()];else p=[];g=!1,w=!1}function o(e){if("string"==typeof e&&(e=e.split(k,2)),!f(e)||2!==e.length)throw new Error("Invalid tags: "+e);d=new RegExp(n(e[0])+"\\s*"),U=new RegExp("\\s*"+n(e[1])),m=new RegExp("\\s*"+n("}"+e[1]))}if(!t)return[];var h=[],l=[],p=[],g=!1,w=!1,d,U,m;o(r||e.tags);for(var E=new u(t),T,j,C,A,R,S;!E.eos();){if(T=E.pos,C=E.scanUntil(d))for(var O=0,q=C.length;q>O;++O)A=C.charAt(O),i(A)?p.push(l.length):w=!0,l.push(["text",A,T,T+1]),T+=1,"\n"===A&&s();if(!E.scan(d))break;if(g=!0,j=E.scan(x)||"name",E.scan(v),"="===j?(C=E.scanUntil(y),E.scan(y),E.scanUntil(U)):"{"===j?(C=E.scanUntil(m),E.scan(b),E.scanUntil(U),j="&"):C=E.scanUntil(U),!E.scan(U))throw new Error("Unclosed tag at "+E.pos);if(R=[j,C,T,E.pos],l.push(R),"#"===j||"^"===j)h.push(R);else if("/"===j){if(S=h.pop(),!S)throw new Error('Unopened section "'+C+'" at '+T);if(S[1]!==C)throw new Error('Unclosed section "'+S[1]+'" at '+T)}else"name"===j||"{"===j||"&"===j?w=!0:"="===j&&o(C)}if(S=h.pop())throw new Error('Unclosed section "'+S[1]+'" at '+E.pos);return c(a(l))}function a(e){for(var t=[],n,r,i=0,s=e.length;s>i;++i)n=e[i],n&&("text"===n[0]&&r&&"text"===r[0]?(r[1]+=n[1],r[3]=n[3]):(t.push(n),r=n));return t}function c(e){for(var t=[],n=t,r=[],i,s,o=0,a=e.length;a>o;++o)switch(i=e[o],i[0]){case"#":case"^":n.push(i),r.push(i),n=i[4]=[];break;case"/":s=r.pop(),s[5]=i[2],n=r.length>0?r[r.length-1][4]:t;break;default:n.push(i)}return t}function u(e){this.string=e,this.tail=e,this.pos=0}function h(e,t){this.view=null==e?{}:e,this.cache={".":this.view},this.parent=t}function l(){this.cache={}}var p=Object.prototype.toString,f=Array.isArray||function(e){return"[object Array]"===p.call(e)},g=RegExp.prototype.test,w=/\S/,d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},v=/\s*/,k=/\s+/,y=/\s*=/,b=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return""===this.tail},u.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},u.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n},h.prototype.push=function(e){return new h(e,this)},h.prototype.lookup=function(e){var n=this.cache,r;if(e in n)r=n[e];else{for(var i=this,s,o;i;){if(e.indexOf(".")>0)for(r=i.view,s=e.split("."),o=0;null!=r&&o<s.length;)r=r[s[o++]];else r=i.view[e];if(null!=r)break;i=i.parent}n[e]=r}return t(r)&&(r=r.call(this.view)),r},l.prototype.clearCache=function(){this.cache={}},l.prototype.parse=function(e,t){var n=this.cache,r=n[e];return null==r&&(r=n[e]=o(e,t)),r},l.prototype.render=function(e,t,n){var r=this.parse(e),i=t instanceof h?t:new h(t);return this.renderTokens(r,i,n,e)},l.prototype.renderTokens=function(n,r,i,s){function o(e){return c.render(e,r,i)}for(var a="",c=this,u,h,l=0,p=n.length;p>l;++l)switch(u=n[l],u[0]){case"#":if(h=r.lookup(u[1]),!h)continue;if(f(h))for(var g=0,w=h.length;w>g;++g)a+=this.renderTokens(u[4],r.push(h[g]),i,s);else if("object"==typeof h||"string"==typeof h)a+=this.renderTokens(u[4],r.push(h),i,s);else if(t(h)){if("string"!=typeof s)throw new Error("Cannot use higher-order sections without the original template");h=h.call(r.view,s.slice(u[3],u[5]),o),null!=h&&(a+=h)}else a+=this.renderTokens(u[4],r,i,s);break;case"^":h=r.lookup(u[1]),(!h||f(h)&&0===h.length)&&(a+=this.renderTokens(u[4],r,i,s));break;case">":if(!i)continue;h=t(i)?i(u[1]):i[u[1]],null!=h&&(a+=this.renderTokens(this.parse(h),r,i,h));break;case"&":h=r.lookup(u[1]),null!=h&&(a+=h);break;case"name":h=r.lookup(u[1]),null!=h&&(a+=e.escape(h));break;case"text":a+=u[1]}return a},e.name="mustache.js",e.version="0.8.1",e.tags=["{{","}}"];var U=new l;e.clearCache=function(){return U.clearCache()},e.parse=function(e,t){return U.parse(e,t)},e.render=function(e,t,n){return U.render(e,t,n)},e.to_html=function(n,r,i,s){var o=e.render(n,r,i);return t(s)?void s(o):o},e.escape=s,e.Scanner=u,e.Context=h,e.Writer=l});